---
title: "Group project assessment [template]"
author: 'B249199, B249281'
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(here)
library(janitor)
library(magrittr)
library(tidyverse)
```

NOTE: Please don't edit this template directly. Use `File` > `Save as` to create a copy of this document, rename it (remove the word "template" from the file name) and use that new version to write your report. Make sure to also update the Title and Author fields in the YAML of your .Rmd file.

## Task 1: Reproducing and improving figures

```{r load-wrangle}
# load and wrangle the data here
data <- read_csv(here("data/HIIT-postpartum-depression.csv")) %>% 
  clean_names()
  
data[data == "#NULL!"] <- NA # standardising missing values to NA's instead of "#NULL!"
```


### Figure 3 - Kai (shaper)
```{r figure-3}
# Write your code for reproducing, and then improving Figure 3. Present both figures together. Under the figures, explain how you've improved Figure 3 and why you consider this an improvement.

```


### Figure 4 - James
```{r figure-4}
# Write your code for reproducing, and then improving Figure 4. Present both figures together. Under the figures, explain how you've improved Figure 4 and why you consider this an improvement.
```


### Figure 5 - Fimi
```{r figure-5}
# Write your code for reproducing, and then improving Figure 5. Present both figures together. Under the figures, explain how you've improved Figure 5 and why you consider this an improvement.

# original reproduction of figure 5
fig5 <- data %>% 
  select(participant_code,intervention_group,pre_sf_12_pcs_physicalhealthscale,post_sf12_pcs,postnatal_sf_12_pcs) %>%
  # select the groups physical health before, after and follow up from intervention
  mutate(pre_sf_12_pcs_physicalhealthscale = as.numeric(pre_sf_12_pcs_physicalhealthscale),post_sf12_pcs = as.numeric(post_sf12_pcs),postnatal_sf_12_pcs = as.numeric(postnatal_sf_12_pcs)) %>% 
# make a new column and make all the columns same value 

  pivot_longer(
    cols = c(pre_sf_12_pcs_physicalhealthscale,
      post_sf12_pcs,
      postnatal_sf_12_pcs ), 
    names_to = "time",
    values_to = "physical_health") %>% 
  # lengthens data and increase number of rows and decreases columns 
    
   mutate(time = factor( time,levels = c(
        "pre_sf_12_pcs_physicalhealthscale",
        "post_sf12_pcs",
        "postnatal_sf_12_pcs"),
      labels = c(
        "Before intervention 
        (II trimester of pregnancy)",
        "After intervention
        (III trimester of pregnancy)",
        "Follow-up
        (Â± 5 months postpartum" ))) %>% 
# changes the name of the time columns to match intervetion timing

    filter(!is.na(physical_health)) %>% 
    mutate(intervention_group = factor(intervention_group))
  
```

```{r figure-5}
# CALCULATE MEAN AND STANDARD DEVIATION

fig5_summary <- fig5 %>% 
  group_by(intervention_group,time)%>% 
  summarise(mean_physical = mean(physical_health),sd_physical = sd(physical_health))
```

```{r}

```


```{r}
ggplot(fig5_summary, aes(x=time,y=mean_physical,
                         group=intervention_group,
                         linetype = intervention_group)) +
  geom_line(size=0.5) +
  geom_errorbar(aes(
    ymin = mean_physical-sd_physical,
    ymax = mean_physical+sd_physical
  ),
  width = 0.05) +
  scale_linetype_manual(values=c("solid","dotted")) +
  labs(title = bquote(bold("Physical health")~"(measured with the Short Form Health Survey-physical subscale)"),
    x="Time",
    y= "Physical health (SF-12 physical subscale)"
  )+
  theme_classic()
```

## Task 2: FAIR data principles

## Task 3: Reproducibility brief
