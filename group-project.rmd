---
title: "Group project assessment [template]"
author: 'B249199, B249281'
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(here)
library(janitor)
library(magrittr)

library(ggplot2)
library(dplyr)
library(tidyr)
```


NOTE: Please don't edit this template directly. Use `File` > `Save as` to create a copy of this document, rename it (remove the word "template" from the file name) and use that new version to write your report. Make sure to also update the Title and Author fields in the YAML of your .Rmd file.

## Task 1: Reproducing and improving figures

```{r load-wrangle}
# load and wrangle the data here
data <- read_csv(here("data/HIIT-postpartum-depression.csv")) %>% 
  clean_names()
  
data[data == "#NULL!"] <- NA # standardising missing values to NA's instead of "#NULL!"

figure3_data <- data %>%
  # assign readable interventions to groups
  mutate(
    group = case_when(
      `intervention_group` == 1 ~ "HIIT – High Intensity Interval Training Group",
      `intervention_group` == 2 ~ "EDU – Educational Intervention Group"
    ),
    # create column for depression score cutoffs
    EPDS = as.numeric(`edinburg_postnatal_depression_scale_score`),
    category = case_when(
      EPDS < 10 ~ "range indicating the norm (below 10 points)",
      EPDS >= 10 & EPDS < 12 ~ "slightly increased severity of PPD symptoms (10-11 points)",
      EPDS >= 12 ~ "increased severity of PPD symptoms (12 or more points)"
    )
  ) %>% 
  # calculate percentages
  drop_na(category) %>%
  count(group, category) %>%
  group_by(group) %>%
  mutate(percent = n / sum(n) * 100) %>% 
  ungroup() %>% 
  mutate(group = factor(group, levels = c(
      "HIIT – High Intensity Interval Training Group",
      "EDU – Educational Intervention Group"
    )),
    category = factor(category, levels = c(
      "increased severity of PPD symptoms (12 or more points)",
      "slightly increased severity of PPD symptoms (10-11 points)",
      "range indicating the norm (below 10 points)"))
  )
```


### Figure 3 - Kai (shaper)
```{r figure-3}
# Write your code for reproducing, and then improving Figure 3. Present both figures together. Under the figures, explain how you've improved Figure 3 and why you consider this an improvement.

# replicated figure 3
ggplot(figure3_data, aes(x = percent, y = group, fill = category)) +
  geom_col(width = 0.25) +
  scale_x_continuous(
    breaks = seq(0, 100, by = 10),
    labels = scales::label_percent(scale = 1, accuracy = 0.01),
    expand = c(0, 0)
  ) +
  scale_fill_manual(
    values = c(
      "range indicating the norm (below 10 points)" = "#9EC1FF",
      "slightly increased severity of PPD symptoms (10-11 points)" = "#0B3C8A",
      "increased severity of PPD symptoms (12 or more points)" = "#C21F17"
    ),
    name = NULL
  ) +
  labs(
    x = NULL,
    y = NULL
  ) +
  theme_minimal(base_size = 12) +
  guides(fill = guide_legend(reverse = TRUE)) +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank(),
    legend.position = "bottom",
    legend.direction = "vertical",
    axis.text.y = element_text(size = 9),
    axis.text.x = element_text(size = 10)
  )

# improved figure 3
ggplot(figure3_data, aes(x = percent, y = group, fill = category)) +
  geom_col(width = 0.25) +
  scale_x_continuous(
    breaks = seq(0, 100, 10),
    minor_breaks = seq(0, 100, 5),
    labels = scales::label_percent(scale = 1, accuracy = 1),
    expand = c(0, 0)
  ) +
  scale_fill_manual(
    values = c(
      "range indicating the norm (below 10 points)" = "#9EC1FF",
      "slightly increased severity of PPD symptoms (10-11 points)" = "#0B3C8A",
      "increased severity of PPD symptoms (12 or more points)" = "#C21F17"
    ),
    name = NULL
  ) +
  geom_text(aes(label = paste0(sprintf("%.2f", percent), "%")), position = position_stack(vjust = 0.5), color = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    title = "Distribution of EDPS results in the Educational Intervention (EDU) and High Intensity Interval Training (HIIT) groups in the postpartum assessment"
  ) +
  theme_minimal(base_size = 12) +
  guides(fill = guide_legend(reverse = TRUE)) +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(),
    panel.grid.minor.x = element_line(),
    legend.position = "bottom",
    legend.direction = "vertical",
    axis.text.y = element_text(size = 9),
    axis.text.x = element_text(size = 10)
  )
```
- Accuracy of x-axis labels changed to 1 for clearer visuals
- Added title for better presentation of information
- Added minor breaks for easier interpretation of data
- Added labels for the numbers in each EDPS subgroup
- Added percentage labels so more valuable information can be gleaned from the graph, showing two decimal places for accuracy

### Figure 4 - James
```{r figure-4}
# Write your code for reproducing, and then improving Figure 4. Present both figures together. Under the figures, explain how you've improved Figure 4 and why you consider this an improvement.
```


### Figure 5 - Fimi
```{r figure-5}
# Write your code for reproducing, and then improving Figure 5. Present both figures together. Under the figures, explain how you've improved Figure 5 and why you consider this an improvement.
```


## Task 2: FAIR data principles

## Task 3: Reproducibility brief
